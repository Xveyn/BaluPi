import{j as e,e as k,u as pe,c as Le,g as F,i as Ee,z as B,d as U,k as Me,A as Te}from"./index-DDikNu0A.js";import{a as r,L as ge,i as $e}from"./vendor-react-ZzjCT2KX.js";import{u as P}from"./vendor-i18n-DuW_MkEn.js";import{R as V,x as be,y as Ae,z as Pe,H as ee,v as se,G as Be,F as fe,I as q,n as K,c as X,u as ae,b as re,J as Ie,K as Fe,k as Ue,D as Ke,T as Re,N as He,h as We,f as ze,S as ie,O as qe,Q as me,p as Z,g as Oe,V as Ge,m as Q,Y as Ve,L as Y,X as Qe,_ as Ye,$ as Xe,a0 as Je,a1 as Ze}from"./vendor-icons-eCvzHHv5.js";import{f as je,p as oe,l as te,c as le,d as ye,e as es,h as ss,S as z,g as ts,i as as,j as rs,k as ls,m as ns,b as is,n as os,o as cs,q as ds,a as ms}from"./monitoring-O4NCQ_UO.js";import{R as ve,A as xs,L as us,C as Ne,X as we,Y as ne,a as hs,T as ke,b as _e,c as Se,d as Ce,e as ps}from"./vendor-charts-Dce8K_o7.js";const gs=s=>(typeof s=="string"?oe(s):new Date(s)).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit",second:"2-digit"});function H({data:s,lines:t,yAxisLabel:a,yAxisDomain:l=["auto","auto"],height:x=300,showArea:m=!1,loading:u=!1,emptyMessage:o,compact:i=!1,showCompactTooltip:h=!0,showReferenceLines:p=!0,timeRange:_}){const{t:f,i18n:N}=P(["system","admin"]),n=N.language,b=_==="7d"||_==="week"?70:40,g=o??f("admin:monitoring.noData"),j=s.map(v=>({...v,time:v.time||(v.timestamp?gs(v.timestamp):"")}));if(u)return e.jsx("div",{className:"flex items-center justify-center",style:{height:x},children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-slate-600 border-t-blue-500"}),e.jsx("p",{className:"mt-2 text-sm text-slate-400",children:f("admin:monitoring.loadingData")})]})});if(s.length===0)return e.jsx("div",{className:"flex items-center justify-center",style:{height:x},children:e.jsxs("div",{className:"text-center",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-slate-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),e.jsx("p",{className:"mt-2 text-sm text-slate-400",children:g})]})});const L=m?xs:us,C=!i||h,E=i&&p&&l[0]===0&&l[1]===100;return e.jsx(ve,{width:"100%",height:x,children:e.jsxs(L,{data:j,children:[!i&&e.jsx(Ne,{strokeDasharray:"3 3",stroke:"#334155"}),e.jsx(we,{dataKey:"time",stroke:i?"transparent":"#94a3b8",tick:i?!1:{fill:"#94a3b8",fontSize:12},tickLine:i?!1:{stroke:"#334155"},axisLine:!i,hide:i,tickFormatter:_?v=>je(v,_,n):void 0,interval:"preserveStartEnd",minTickGap:b}),e.jsx(ne,{stroke:i?"transparent":"#94a3b8",tick:i?!1:{fill:"#94a3b8",fontSize:12},tickLine:i?!1:{stroke:"#334155"},axisLine:!i,domain:l,hide:i,label:!i&&a?{value:a,angle:-90,position:"insideLeft",style:{fill:"#94a3b8",fontSize:12}}:void 0}),E&&e.jsx(hs,{y:50,stroke:"#475569",strokeDasharray:"2 4",strokeWidth:1}),C&&e.jsx(ke,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px",color:"#f1f5f9",padding:i?"4px 8px":void 0,fontSize:i?"11px":void 0},labelStyle:{color:"#94a3b8",display:i?"none":void 0},formatter:v=>i?[`${k(v,0)}%`]:[k(v,1)],labelFormatter:_&&!i?v=>(typeof v=="string"?oe(v):new Date(v)).toLocaleString(n):void 0}),!i&&e.jsx(_e,{wrapperStyle:{color:"#94a3b8"},iconType:"line"}),t.map(v=>m?e.jsx(Se,{type:"monotone",dataKey:v.dataKey,stroke:v.color,fill:v.color,fillOpacity:i?.25:.1,strokeWidth:v.strokeWidth||(i?1.5:2),name:v.name,dot:!1,animationDuration:i?150:300},v.dataKey):e.jsx(Ce,{type:"monotone",dataKey:v.dataKey,stroke:v.color,strokeWidth:v.strokeWidth||(i?1.5:2),name:v.name,dot:!1,animationDuration:i?150:300},v.dataKey))]})})}const bs=["10m","1h","24h","7d"];function fs({value:s,onChange:t,className:a=""}){const{t:l}=P(["system","admin"]),x=bs.map(m=>({value:m,label:l(`admin:monitoring.timeRanges.${m}`)}));return e.jsx("div",{className:`flex gap-1 sm:gap-2 ${a}`,children:x.map(m=>e.jsx("button",{onClick:()=>t(m.value),className:`rounded-lg px-2.5 sm:px-3 py-1.5 text-xs sm:text-sm font-medium transition-all ${s===m.value?"bg-blue-500/20 text-blue-400 border border-blue-500/40":"text-slate-400 hover:bg-slate-800 border border-slate-700/50 hover:border-slate-600"}`,children:m.label},m.value))})}function js(){const{t:s}=P("admin"),{token:t}=pe(),[a,l]=r.useState(null),[x,m]=r.useState(!0),[u,o]=r.useState(null),i=r.useCallback(async()=>{m(!0),o(null);try{const p=await fetch(Le("/api/system/health"),{headers:t?{Authorization:`Bearer ${t}`}:void 0});if(!p.ok)throw new Error(await p.text());const _=await p.json();l(_)}catch(p){o(p?.message||s("health.loadError"))}finally{m(!1)}},[s]),h=()=>{i()};return r.useEffect(()=>{i()},[i]),e.jsxs("div",{className:"space-y-8 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:s("health.title")}),e.jsx("p",{className:"text-sm text-slate-400",children:s("health.subtitle")})]}),e.jsxs("button",{onClick:h,disabled:x,className:"flex items-center gap-2 min-h-[44px] rounded-xl border border-slate-700/70 bg-slate-800/50 px-4 py-2.5 text-sm font-medium text-slate-300 transition hover:border-sky-500/50 hover:text-white disabled:opacity-50",children:[e.jsx(V,{className:`h-4 w-4 ${x?"animate-spin":""}`}),s(x?"health.refreshing":"common:buttons.refresh")]})]}),u&&e.jsx("div",{className:"card border-rose-500/30 bg-rose-500/10 text-sm text-rose-100",children:u}),a&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-3 sm:gap-5",children:[e.jsxs("div",{className:"card border-slate-800/40 bg-slate-900/60",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-violet-500/20",children:e.jsx(be,{className:"h-5 w-5 text-violet-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:"CPU"}),e.jsxs("p",{className:"text-lg font-semibold text-white",children:[k(a.system.cpu.usage,1),"%"]})]})]}),e.jsxs("div",{className:"space-y-2 text-xs text-slate-400",children:[e.jsx("p",{className:"truncate",title:a.system.cpu.model,children:a.system.cpu.model}),e.jsxs("p",{children:[a.system.cpu.cores," cores @ ",k(a.system.cpu.frequency_mhz/1e3,2)," GHz"]}),a.system.cpu.temperature_celsius&&e.jsxs("p",{className:"flex items-center gap-1",children:[e.jsx(Ae,{className:"h-3.5 w-3.5"}),k(a.system.cpu.temperature_celsius,1),"Â°C"]})]})]}),e.jsxs("div",{className:"card border-slate-800/40 bg-slate-900/60",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-sky-500/20",children:e.jsx(Pe,{className:"h-5 w-5 text-sky-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Memory"}),e.jsx("p",{className:"text-lg font-semibold text-white",children:F(a.system.memory.used)})]})]}),e.jsxs("div",{className:"space-y-2 text-xs text-slate-400",children:[e.jsxs("p",{children:["of ",F(a.system.memory.total)," total"]}),e.jsxs("p",{children:[F(a.system.memory.free)," free"]}),a.system.memory.type&&a.system.memory.speed_mts&&e.jsxs("p",{children:[a.system.memory.type," @ ",a.system.memory.speed_mts," MT/s"]})]}),e.jsx("div",{className:"mt-3 h-2 w-full overflow-hidden rounded-full bg-slate-800",children:e.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-sky-500 to-indigo-500",style:{width:`${a.system.memory.used/a.system.memory.total*100}%`}})})]}),e.jsxs("div",{className:"card border-slate-800/40 bg-slate-900/60",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-cyan-500/20",children:e.jsx(ee,{className:"h-5 w-5 text-cyan-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Disk"}),e.jsx("p",{className:"text-lg font-semibold text-white",children:F(a.system.disk.used)})]})]}),e.jsxs("div",{className:"space-y-2 text-xs text-slate-400",children:[e.jsxs("p",{children:["of ",F(a.system.disk.total)," total"]}),e.jsxs("p",{children:[F(a.system.disk.free)," free"]}),a.smart?.devices.length&&e.jsxs("p",{children:[a.smart.devices.length," drive",a.smart.devices.length>1?"s":""," detected"]})]}),e.jsx("div",{className:"mt-3 h-2 w-full overflow-hidden rounded-full bg-slate-800",children:e.jsx("div",{className:"h-full rounded-full bg-gradient-to-r from-cyan-500 to-sky-600",style:{width:`${a.system.disk.used/a.system.disk.total*100}%`}})})]}),e.jsxs("div",{className:"card border-slate-800/40 bg-slate-900/60",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-emerald-500/20",children:e.jsx(se,{className:"h-5 w-5 text-emerald-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-slate-500",children:"Uptime"}),e.jsx("p",{className:"text-lg font-semibold text-white",children:Ee(a.system.uptime)})]})]}),e.jsxs("div",{className:"space-y-2 text-xs text-slate-400",children:[e.jsxs("p",{children:[s("health.systemStatus"),": ",e.jsx("span",{className:"text-emerald-400",children:a.status})]}),e.jsxs("p",{children:[s("health.mode"),": ",a.system.dev_mode?s("health.development"):s("health.production")]}),a.raid?.arrays.length?e.jsx("p",{children:s("health.raidArrays",{count:a.raid.arrays.length})}):e.jsx("p",{children:s("health.noRaidConfigured")})]})]})]}),a?.smart?.devices&&a.smart.devices.length>0&&e.jsxs("div",{className:"card border-slate-800/50 bg-slate-900/55",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx(ee,{className:"h-5 w-5 text-sky-400"}),e.jsx("h2",{className:"text-lg font-semibold text-white",children:s("health.storageDevices")})]}),e.jsx("div",{className:"space-y-3",children:a.smart.devices.map(p=>e.jsxs("div",{className:"rounded-xl border border-slate-800 bg-slate-900/70 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-slate-100",children:p.model}),e.jsxs("p",{className:"text-xs text-slate-500",children:[p.name," â€¢ ",p.serial]})]}),e.jsx("span",{className:`rounded-full border px-2 py-0.5 text-xs ${p.status==="PASSED"?"border-emerald-500/30 bg-emerald-500/10 text-emerald-300":p.status==="UNKNOWN"?"border-amber-500/30 bg-amber-500/10 text-amber-300":"border-rose-500/30 bg-rose-500/10 text-rose-300"}`,children:p.status})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 min-[400px]:grid-cols-2 sm:grid-cols-4 gap-4 text-xs",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500",children:s("health.deviceLabels.capacity")}),e.jsx("p",{className:"text-slate-200",children:F(p.capacity_bytes)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500",children:s("health.deviceLabels.used")}),e.jsxs("p",{className:"text-slate-200",children:[p.used_percent!=null?k(p.used_percent,1):"-","%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500",children:s("health.deviceLabels.mount")}),e.jsx("p",{className:"text-slate-200",children:p.mount_point})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500",children:s("health.deviceLabels.temperature")}),e.jsx("p",{className:"text-slate-200",children:p.temperature!==null?`${p.temperature}Â°C`:p.attributes?.find(_=>_.id===194)?`${p.attributes.find(_=>_.id===194).raw}Â°C`:"N/A"})]})]})]},p.serial))})]})]})}function ys(){const{t:s}=P(["system","common"]),[t,a]=r.useState(null),[l,x]=r.useState(null),[m,u]=r.useState(24),[o,i]=r.useState(""),[h,p]=r.useState(""),[_,f]=r.useState(!0),[N,n]=r.useState(null),[b,g]=r.useState(!1);r.useEffect(()=>{j()},[m,o,h]);const j=async()=>{try{f(!0),n(null);const[c,M]=await Promise.all([te.getFileAccessLogs({limit:100,days:Math.ceil(m/24),action:o||void 0,user:h||void 0}),te.getAuditLoggingStatus().catch(()=>null)]);a(c),x(M)}catch(c){const M=c instanceof Error?c.message:"Failed to load logging data";n(M)}finally{f(!1)}},L=async()=>{if(l){g(!0);try{const c=await te.toggleAuditLogging(!l.enabled);x(c),B.success(c.enabled?s("logging.enabledSuccess"):s("logging.disabledSuccess"))}catch(c){const M=c instanceof Error?c.message:s("logging.toggleError");B.error(M)}finally{g(!1)}}},C=c=>c?F(c):"-",E=le,v=Array.from(new Set(t?.logs.map(c=>c.action)||[])).sort(),y=Array.from(new Set(t?.logs.map(c=>c.user)||[])).sort(),w=c=>c==="read"||c==="download"?"border border-green-500/40 bg-green-500/15 text-green-300":c==="write"||c==="upload"||c==="create"?"border border-yellow-500/40 bg-yellow-500/15 text-yellow-300":c==="delete"?"border border-rose-500/40 bg-rose-500/15 text-rose-300":"border border-slate-700/70 bg-slate-900/70 text-slate-300";return _?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-slate-400",children:s("common:loading")})}):N?e.jsxs("div",{className:"card border-red-900/60 bg-red-950/30 p-4",children:[e.jsx("p",{className:"font-bold text-red-400",children:s("common:error")}),e.jsx("p",{className:"text-red-300",children:N})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:s("logging.title")}),e.jsxs("p",{className:"text-xs sm:text-sm text-slate-400",children:[s("logging.description"),l&&e.jsxs("span",{className:`ml-2 text-xs ${l.enabled?"text-green-400":"text-yellow-400"}`,children:["(",l.enabled?s("logging.loggingEnabled"):s("logging.loggingDisabled"),")"]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[l?.can_toggle&&e.jsxs("button",{onClick:L,disabled:b,className:`flex items-center gap-2 px-3 sm:px-4 py-2 rounded-lg border text-xs sm:text-sm font-medium transition-all touch-manipulation active:scale-95 ${l.enabled?"border-green-500/40 bg-green-500/10 text-green-300 hover:bg-green-500/20":"border-yellow-500/40 bg-yellow-500/10 text-yellow-300 hover:bg-yellow-500/20"} ${b?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx(Be,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:b?s("logging.toggling"):l.enabled?s("logging.disableLogging"):s("logging.enableLogging")}),e.jsx("span",{className:"sm:hidden",children:l.enabled?s("common:off"):s("common:on")})]}),e.jsxs("select",{value:m,onChange:c=>u(Number(c.target.value)),className:"flex-1 sm:flex-initial rounded-lg border border-slate-700 bg-slate-900/70 px-3 sm:px-4 py-2 text-xs sm:text-sm text-slate-200 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",children:[e.jsx("option",{value:1,children:s("logging.lastHour",{count:1})}),e.jsx("option",{value:6,children:s("logging.lastHours",{count:6})}),e.jsx("option",{value:24,children:s("logging.lastHours",{count:24})}),e.jsx("option",{value:72,children:s("logging.lastDays",{count:3})}),e.jsx("option",{value:168,children:s("logging.lastWeek")})]}),e.jsxs("button",{onClick:j,className:"btn btn-primary flex items-center gap-2 justify-center touch-manipulation active:scale-95",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:s("common:refresh")})]})]})]}),e.jsxs("div",{className:"card border-slate-800/60 bg-slate-900/55 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col gap-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"h-5 w-5 text-slate-400"}),e.jsx("h3",{className:"text-lg sm:text-xl font-semibold text-white",children:s("logging.fileAccessLogs")})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs("select",{value:o,onChange:c=>i(c.target.value),className:"flex-1 sm:flex-initial rounded-lg border border-slate-700 bg-slate-900/70 px-3 py-2 text-xs sm:text-sm text-slate-200 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",children:[e.jsx("option",{value:"",children:s("logging.allActions")}),v.map(c=>e.jsx("option",{value:c,children:c},c))]}),e.jsxs("select",{value:h,onChange:c=>p(c.target.value),className:"flex-1 sm:flex-initial rounded-lg border border-slate-700 bg-slate-900/70 px-3 py-2 text-xs sm:text-sm text-slate-200 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",children:[e.jsx("option",{value:"",children:s("logging.allUsers")}),y.map(c=>e.jsx("option",{value:c,children:c},c))]})]})]}),t&&t.logs.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden lg:block overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-800/60",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-xs font-medium text-slate-400 uppercase tracking-wider",children:[e.jsx("th",{className:"px-4 py-3",children:s("logging.timestamp")}),e.jsx("th",{className:"px-4 py-3",children:s("logging.user")}),e.jsx("th",{className:"px-4 py-3",children:s("logging.action")}),e.jsx("th",{className:"px-4 py-3",children:s("logging.file")}),e.jsx("th",{className:"px-4 py-3",children:s("logging.size")}),e.jsx("th",{className:"px-4 py-3",children:s("logging.duration")}),e.jsx("th",{className:"px-4 py-3",children:s("logging.status")})]})}),e.jsx("tbody",{className:"divide-y divide-slate-800/60",children:t.logs.map((c,M)=>e.jsxs("tr",{className:"text-sm text-slate-300 hover:bg-slate-800/50 transition",children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-slate-400",children:E(c.timestamp)}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium border border-sky-500/40 bg-sky-500/15 text-sky-300",children:c.user})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${w(c.action)}`,children:c.action})}),e.jsx("td",{className:"px-4 py-3 max-w-xs truncate",title:c.resource,children:c.resource}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:C(c.details?.size_bytes)}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:c.details?.duration_ms?`${c.details.duration_ms}ms`:"-"}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:c.success?e.jsxs("span",{className:"inline-flex items-center text-green-400",children:[e.jsx(q,{className:"h-4 w-4 mr-1"}),s("logging.success")]}):e.jsxs("span",{className:"inline-flex items-center text-red-400",title:c.error,children:[e.jsx(K,{className:"h-4 w-4 mr-1"}),s("logging.failed")]})})]},M))})]})}),e.jsx("div",{className:"lg:hidden space-y-3",children:t.logs.map((c,M)=>e.jsxs("div",{className:"rounded-xl border border-slate-800/60 bg-slate-950/70 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border border-sky-500/40 bg-sky-500/15 text-sky-300",children:c.user}),e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${w(c.action)}`,children:c.action})]}),c.success?e.jsx(q,{className:"h-5 w-5 text-green-400 flex-shrink-0"}):e.jsx(K,{className:"h-5 w-5 text-red-400 flex-shrink-0"})]}),e.jsx("p",{className:"text-sm text-slate-200 break-all mb-2",title:c.resource,children:c.resource}),e.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 text-xs text-slate-400",children:[e.jsx("span",{children:E(c.timestamp)}),c.details?.size_bytes&&e.jsx("span",{children:C(c.details.size_bytes)}),c.details?.duration_ms&&e.jsxs("span",{children:[c.details.duration_ms,"ms"]})]}),!c.success&&c.error&&e.jsx("p",{className:"mt-2 text-xs text-red-400",children:c.error})]},M))})]}):e.jsx("div",{className:"text-center py-8 text-slate-400",children:s("logging.noLogsFound")}),t&&t.total>t.logs.length&&e.jsx("div",{className:"mt-4 text-center text-sm text-slate-400",children:s("logging.showingOfTotal",{shown:t.logs.length,total:t.total})})]})]})}const xe=s=>{const t=s.toLowerCase().replace(/_/g," ");return t.includes("login")?Ie:t.includes("logout")?Fe:t.includes("upload")?Ue:t.includes("download")?Ke:t.includes("delete")?Re:t.includes("create")||t.includes("folder")?He:t.includes("share")?We:t.includes("security")||t.includes("auth")?ze:t.includes("setting")||t.includes("config")?ie:se},ue=s=>{const t=s.toLowerCase().replace(/_/g," ");return t.includes("login")?"text-green-400 bg-green-500/20 border-green-500/40":t.includes("logout")?"text-yellow-400 bg-yellow-500/20 border-yellow-500/40":t.includes("upload")||t.includes("create")?"text-blue-400 bg-blue-500/20 border-blue-500/40":t.includes("download")?"text-cyan-400 bg-cyan-500/20 border-cyan-500/40":t.includes("delete")?"text-red-400 bg-red-500/20 border-red-500/40":t.includes("share")?"text-purple-400 bg-purple-500/20 border-purple-500/40":"text-slate-400 bg-slate-500/20 border-slate-500/40"};function vs({user:s}){const{t}=P(["system","common"]),[a,l]=r.useState([]),[x,m]=r.useState(!0),[u,o]=r.useState(null),[i,h]=r.useState(""),[p,_]=r.useState(""),[f,N]=r.useState(new Set),[n,b]=r.useState(0),g=s?.role==="admin";r.useEffect(()=>{j()},[i,p]);const j=async()=>{m(!0),o(null);try{const y={limit:100,sort_order:"desc"};i&&(y.action_filter=i),p&&(y.user_filter=p);const w=await U.get("/api/logging/audit",{params:y});l(w.data.logs||[]),b(w.data.total||w.data.logs?.length||0)}catch(y){const w=y instanceof Error?y.message:t("monitor.activity.loadError");o(w),B.error(t("monitor.activity.loadError"))}finally{m(!1)}},L=y=>{N(w=>{const c=new Set(w);return c.has(y)?c.delete(y):c.add(y),c})},C=r.useMemo(()=>{const y=new Date,w=new Date(y.getFullYear(),y.getMonth(),y.getDate()),c=new Date(w);c.setDate(c.getDate()-1);const M=new Date(w);M.setDate(M.getDate()-7);const $=[{label:t("monitor.activity.today"),logs:[]},{label:t("monitor.activity.yesterday"),logs:[]},{label:t("monitor.activity.thisWeek"),logs:[]},{label:t("monitor.activity.earlier"),logs:[]}];return a.forEach(I=>{const d=new Date(I.timestamp);d>=w?$[0].logs.push(I):d>=c?$[1].logs.push(I):d>=M?$[2].logs.push(I):$[3].logs.push(I)}),$.filter(I=>I.logs.length>0)},[a,t]),E=r.useMemo(()=>Array.from(new Set(a.map(y=>y.action))).sort(),[a]),v=r.useMemo(()=>Array.from(new Set(a.map(y=>y.user||y.username).filter(Boolean))).sort(),[a]);return x?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-slate-400",children:t("common:loading")})}):u?e.jsxs("div",{className:"card border-red-900/60 bg-red-950/30 p-4",children:[e.jsx("p",{className:"font-bold text-red-400",children:t("common:error")}),e.jsx("p",{className:"text-red-300",children:u})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:t("monitor.activity.title")}),e.jsx("p",{className:"text-xs sm:text-sm text-slate-400",children:t("monitor.activity.description")})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3",children:[e.jsxs("select",{value:i,onChange:y=>h(y.target.value),className:"flex-1 sm:flex-initial rounded-lg border border-slate-700 bg-slate-900/70 px-3 sm:px-4 py-2 text-xs sm:text-sm text-slate-200 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",children:[e.jsx("option",{value:"",children:t("monitor.activity.allActions")}),E.map(y=>e.jsx("option",{value:y,children:y.replace(/_/g," ")},y))]}),g&&e.jsxs("select",{value:p,onChange:y=>_(y.target.value),className:"flex-1 sm:flex-initial rounded-lg border border-slate-700 bg-slate-900/70 px-3 sm:px-4 py-2 text-xs sm:text-sm text-slate-200 focus:border-sky-500 focus:outline-none focus:ring-1 focus:ring-sky-500",children:[e.jsx("option",{value:"",children:t("monitor.activity.allUsers")}),v.map(y=>e.jsx("option",{value:y,children:y},y))]}),e.jsxs("button",{onClick:j,className:"btn btn-primary flex items-center gap-2 justify-center touch-manipulation active:scale-95",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:t("common:refresh")})]})]})]}),e.jsxs("div",{className:"card border-slate-800/60 bg-slate-900/55 p-4 sm:p-6",children:[C.length>0?e.jsx("div",{className:"space-y-6",children:C.map(y=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(X,{className:"h-4 w-4 text-slate-500"}),e.jsx("h3",{className:"text-sm font-medium text-slate-400 uppercase tracking-wider",children:y.label}),e.jsx("div",{className:"flex-1 border-t border-slate-800/60"})]}),e.jsx("div",{className:"hidden lg:block space-y-3",children:y.logs.map(w=>{const c=xe(w.action),M=ue(w.action),$=f.has(w.id),I=Object.keys(w.details||{}).length>0,d=w.user||w.username;return e.jsxs("div",{className:"flex items-start gap-4 p-4 rounded-xl border border-slate-800/60 bg-slate-950/70 hover:bg-slate-950/90 transition-colors",children:[e.jsx("div",{className:`p-2 rounded-lg border ${M}`,children:e.jsx(c,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx("span",{className:"font-medium text-white",children:w.action.replace(/_/g," ")}),d&&e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border border-sky-500/40 bg-sky-500/15 text-sky-300",children:d}),w.success?e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs text-green-400",children:[e.jsx(q,{className:"h-3 w-3"}),t("monitor.activity.success")]}):e.jsxs("span",{className:"inline-flex items-center gap-1 text-xs text-red-400",children:[e.jsx(K,{className:"h-3 w-3"}),t("monitor.activity.failed")]})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:le(w.timestamp)}),I&&e.jsxs("div",{className:"mt-2",children:[e.jsx("button",{onClick:()=>L(w.id),className:"flex items-center gap-1 text-xs text-slate-400 hover:text-slate-300 transition-colors",children:$?e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"h-3 w-3"}),t("monitor.activity.hideDetails")]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"h-3 w-3"}),t("monitor.activity.viewDetails")]})}),$&&e.jsx("pre",{className:"mt-2 p-3 rounded-lg bg-slate-900/70 border border-slate-800/60 text-xs text-emerald-400 overflow-x-auto",children:JSON.stringify(w.details,null,2)})]})]})]},w.id)})}),e.jsx("div",{className:"lg:hidden space-y-3",children:y.logs.map(w=>{const c=xe(w.action),M=ue(w.action),$=f.has(w.id),I=Object.keys(w.details||{}).length>0,d=w.user||w.username;return e.jsx("div",{className:"p-4 rounded-xl border border-slate-800/60 bg-slate-950/70",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg border ${M}`,children:e.jsx(c,{className:"h-4 w-4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2",children:[e.jsx("span",{className:"font-medium text-white text-sm",children:w.action.replace(/_/g," ")}),w.success?e.jsx(q,{className:"h-4 w-4 text-green-400 flex-shrink-0"}):e.jsx(K,{className:"h-4 w-4 text-red-400 flex-shrink-0"})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 flex-wrap",children:[d&&e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium border border-sky-500/40 bg-sky-500/15 text-sky-300",children:d}),e.jsx("span",{className:"text-xs text-slate-500",children:le(w.timestamp)})]}),I&&e.jsxs("div",{className:"mt-2",children:[e.jsx("button",{onClick:()=>L(w.id),className:"flex items-center gap-1 text-xs text-slate-400 hover:text-slate-300 transition-colors",children:$?e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"h-3 w-3"}),t("monitor.activity.hideDetails")]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"h-3 w-3"}),t("monitor.activity.viewDetails")]})}),$&&e.jsx("pre",{className:"mt-2 p-3 rounded-lg bg-slate-900/70 border border-slate-800/60 text-xs text-emerald-400 overflow-x-auto",children:JSON.stringify(w.details,null,2)})]})]})]})},w.id)})})]},y.label))}):e.jsxs("div",{className:"text-center py-12 text-slate-400",children:[e.jsx(se,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:t("monitor.activity.noActivity")})]}),n>a.length&&e.jsx("div",{className:"mt-4 text-center text-sm text-slate-400",children:t("monitor.activity.showingOfTotal",{shown:a.length,total:n})})]})]})}function Ns({dependencies:s}){const{t}=P(["system","common"]);return e.jsxs("div",{className:"card border-slate-800/40",children:[e.jsxs("h3",{className:"font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(qe,{className:"w-5 h-5 text-slate-400"}),t("system:services.dependencies.title")]}),e.jsx("div",{className:"space-y-3",children:s.map(a=>e.jsxs("div",{className:`p-3 rounded-lg border ${a.available?"border-green-500/20 bg-green-500/5":"border-red-500/20 bg-red-500/5"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[a.available?e.jsx(q,{className:"w-4 h-4 text-green-500"}):e.jsx(K,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{className:"font-medium text-white",children:a.name})]}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${a.available?"bg-green-500/20 text-green-400":"bg-red-500/20 text-red-400"}`,children:a.available?t("system:services.dependencies.available"):t("system:services.dependencies.notFound")})]}),a.available&&a.path&&e.jsxs("p",{className:"text-xs text-slate-400 mb-1 truncate",title:a.path,children:[t("system:services.dependencies.path"),": ",a.path]}),a.available&&a.version&&e.jsxs("p",{className:"text-xs text-slate-400 mb-1 truncate",title:a.version,children:[t("system:services.dependencies.version"),": ",a.version]}),a.required_for.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:a.required_for.map(l=>e.jsx("span",{className:"px-1.5 py-0.5 bg-slate-700 text-slate-300 rounded text-xs",children:l},l))})]},a.name))})]})}function ws({metrics:s}){const{t}=P(["system","common"]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"card border-slate-800/40",children:[e.jsxs("h3",{className:"font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5 text-slate-400"}),t("system:services.metrics.title")]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 sm:gap-4",children:[e.jsxs("div",{className:"p-3 bg-slate-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-1",children:[e.jsx(X,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:t("system:services.metrics.serverUptime")})]}),e.jsx("p",{className:"text-lg font-bold text-white",children:ye(s.server_uptime_seconds)})]}),e.jsxs("div",{className:"p-3 bg-slate-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-1",children:[e.jsx(me,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:t("system:services.metrics.activeTasks")})]}),e.jsx("p",{className:"text-lg font-bold text-white",children:s.active_tasks})]}),e.jsxs("div",{className:"p-3 bg-slate-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-1",children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:t("system:services.metrics.memory")})]}),e.jsx("p",{className:"text-lg font-bold text-white",children:es(s.memory_bytes)}),e.jsxs("p",{className:"text-xs text-slate-400",children:[k(s.memory_percent,1),"%"]})]}),e.jsxs("div",{className:"p-3 bg-slate-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400 mb-1",children:[e.jsx(Oe,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs",children:t("system:services.metrics.apiErrors")})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("p",{className:`text-lg font-bold ${s.error_count_5xx>0?"text-red-400":"text-white"}`,children:[s.error_count_5xx,e.jsx("span",{className:"text-xs text-slate-400 ml-1",children:"5xx"})]}),e.jsxs("p",{className:`text-lg font-bold ${s.error_count_4xx>0?"text-yellow-400":"text-white"}`,children:[s.error_count_4xx,e.jsx("span",{className:"text-xs text-slate-400 ml-1",children:"4xx"})]})]})]})]})]}),s.db_pool_status&&e.jsxs("div",{className:"card border-slate-800/40",children:[e.jsxs("h3",{className:"font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(Ge,{className:"w-5 h-5 text-slate-400"}),t("system:services.metrics.dbPool")]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 sm:gap-4",children:[e.jsxs("div",{className:"p-3 bg-slate-800/50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:t("system:services.metrics.poolSize")}),e.jsx("p",{className:"text-lg font-bold text-white",children:s.db_pool_status.pool_size})]}),e.jsxs("div",{className:"p-3 bg-slate-800/50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:t("system:services.metrics.available")}),e.jsx("p",{className:"text-lg font-bold text-green-400",children:s.db_pool_status.checked_in})]}),e.jsxs("div",{className:"p-3 bg-slate-800/50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:t("system:services.metrics.inUse")}),e.jsx("p",{className:`text-lg font-bold ${s.db_pool_status.checked_out>0?"text-yellow-400":"text-white"}`,children:s.db_pool_status.checked_out})]}),e.jsxs("div",{className:"p-3 bg-slate-800/50 rounded-lg",children:[e.jsx("p",{className:"text-xs text-slate-400 mb-1",children:t("system:services.metrics.overflow")}),e.jsx("p",{className:`text-lg font-bold ${s.db_pool_status.overflow>0?"text-red-400":"text-white"}`,children:s.db_pool_status.overflow})]})]})]}),s.cache_stats.length>0&&e.jsxs("div",{className:"card border-slate-800/40",children:[e.jsxs("h3",{className:"font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(me,{className:"w-5 h-5 text-slate-400"}),t("system:services.metrics.cache")]}),e.jsx("div",{className:"space-y-3",children:s.cache_stats.map(a=>{const l=a.hits+a.misses>0?k(a.hits/(a.hits+a.misses)*100,1):k(0,1);return e.jsxs("div",{className:"p-3 bg-slate-800/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium text-white",children:a.name}),e.jsxs("span",{className:"text-sm text-green-400",children:[l,"% ",t("system:services.metrics.hitRate")]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400",children:t("system:services.metrics.hits")}),e.jsx("p",{className:"text-white",children:a.hits.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400",children:t("system:services.metrics.misses")}),e.jsx("p",{className:"text-white",children:a.misses.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400",children:t("system:services.metrics.size")}),e.jsx("p",{className:"text-white",children:a.size})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400",children:t("system:services.metrics.maxSize")}),e.jsx("p",{className:"text-white",children:a.max_size??"-"})]})]})]},a.name)})})]})]})}function ks({service:s}){const{t}=P(["system","common"]),a=()=>{switch(s.state){case z.RUNNING:return e.jsx(q,{className:"w-5 h-5 text-green-500"});case z.STOPPED:return e.jsx(K,{className:"w-5 h-5 text-gray-500"});case z.ERROR:return e.jsx(Q,{className:"w-5 h-5 text-red-500"});case z.DISABLED:return e.jsx(K,{className:"w-5 h-5 text-yellow-500"});default:return e.jsx(X,{className:"w-5 h-5 text-gray-500"})}};return e.jsxs("div",{className:"card border-slate-800/40",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[a(),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-white",children:s.display_name}),e.jsx("p",{className:"text-xs text-slate-400",children:s.name})]})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${ss(s.state)}`,children:s.state.toUpperCase()})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400",children:t("system:services.card.uptime")}),e.jsx("p",{className:"text-sm font-medium text-white",children:ye(s.uptime_seconds)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400",children:t("system:services.card.samples")}),e.jsx("p",{className:"text-sm font-medium text-white",children:s.sample_count?.toLocaleString()??"-"})]})]}),s.error_count>0&&e.jsxs("div",{className:"mb-3 p-2 bg-red-500/10 border border-red-500/20 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-400 text-sm",children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsx("span",{children:t("system:services.card.errors",{count:s.error_count})})]}),s.last_error&&e.jsx("p",{className:"text-xs text-red-300 mt-1 truncate",title:s.last_error,children:s.last_error})]}),s.interval_seconds&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-slate-400",children:t("system:services.card.interval")}),e.jsx("p",{className:"text-sm font-medium text-white",children:s.interval_seconds>=60?`${Math.round(s.interval_seconds/60)}m`:`${s.interval_seconds}s`})]}),!s.config_enabled&&e.jsx("div",{className:"mt-3 p-2 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:e.jsx("p",{className:"text-xs text-yellow-400",children:t("system:services.card.disabledInConfig")})})]})}function _s({isAdmin:s=!1}){const{t}=P(["system","common"]),[a,l]=r.useState(null),[x,m]=r.useState(!0),[u,o]=r.useState(null),[i,h]=r.useState(null),p=r.useCallback(async()=>{try{o(null);const j=await ts();l(j),h(new Date)}catch(j){const L=j!=null&&typeof j=="object"&&"response"in j?j.response?.data?.detail:j instanceof Error?j.message:void 0;o(L||"Failed to load service status")}finally{m(!1)}},[]);r.useEffect(()=>{p();const j=setInterval(p,1e4);return()=>clearInterval(j)},[p]);const _=async()=>{m(!0),await p()};if(x&&!a)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(V,{className:"w-8 h-8 text-sky-500 animate-spin"})});if(u)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Q,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-red-400",children:u}),e.jsx("button",{onClick:_,className:"mt-4 px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors",children:t("system:services.retry")})]})});if(!a)return null;const f=a.services.filter(j=>j.state===z.RUNNING).length,N=a.services.filter(j=>j.state===z.STOPPED).length,n=a.services.filter(j=>j.state===z.ERROR).length,b=a.services.filter(j=>j.state===z.DISABLED).length,g=a.dependencies.filter(j=>j.available).length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(Z,{className:"w-6 h-6 text-slate-400"}),t("system:services.title")]}),i&&e.jsxs("p",{className:"text-xs text-slate-400 mt-1",children:[t("system:services.lastUpdated"),": ",i.toLocaleTimeString()]})]}),e.jsxs("button",{onClick:_,disabled:x,className:"px-4 py-2 flex items-center gap-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors disabled:opacity-50",children:[e.jsx(V,{className:`w-4 h-4 ${x?"animate-spin":""}`}),t("system:services.refresh")]})]}),s&&e.jsxs("div",{className:"p-3 bg-sky-500/10 border border-sky-500/30 rounded-lg flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sky-300 text-sm",children:[e.jsx(ie,{className:"w-4 h-4"}),e.jsx("span",{children:t("system:servicesStatus.viewOnlyHint")})]}),e.jsxs(ge,{to:"/admin/system-control?tab=services",className:"text-sky-400 hover:text-sky-300 text-sm font-medium transition-colors",children:[t("system:servicesStatus.goToControl")," â†’"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"card border-slate-800/40 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-500/20 rounded-lg",children:e.jsx(q,{className:"w-5 h-5 text-green-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:f}),e.jsx("p",{className:"text-xs text-slate-400",children:t("system:services.summary.running")})]})]}),e.jsxs("div",{className:"card border-slate-800/40 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-slate-500/20 rounded-lg",children:e.jsx(Ve,{className:"w-5 h-5 text-slate-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:N}),e.jsx("p",{className:"text-xs text-slate-400",children:t("system:services.summary.stopped")})]})]}),e.jsxs("div",{className:"card border-slate-800/40 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-500/20 rounded-lg",children:e.jsx(Q,{className:"w-5 h-5 text-red-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:n}),e.jsx("p",{className:"text-xs text-slate-400",children:t("system:services.summary.errors")})]})]}),e.jsxs("div",{className:"card border-slate-800/40 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-yellow-500/20 rounded-lg",children:e.jsx(Z,{className:"w-5 h-5 text-yellow-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:b}),e.jsx("p",{className:"text-xs text-slate-400",children:t("system:services.summary.disabled")})]})]}),e.jsxs("div",{className:"card border-slate-800/40 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-sky-500/20 rounded-lg",children:e.jsx(Z,{className:"w-5 h-5 text-sky-500"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-2xl font-bold text-white",children:[g,"/",a.dependencies.length]}),e.jsx("p",{className:"text-xs text-slate-400",children:t("system:services.summary.dependencies")})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:t("system:services.backgroundServices")}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.services.map(j=>e.jsx(ks,{service:j},j.name))})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Ns,{dependencies:a.dependencies}),e.jsx(ws,{metrics:a.metrics})]})]})}function Ss(s={}){const{pollInterval:t=5e3,historyDuration:a="1h",source:l="auto",enabled:x=!0}=s,[m,u]=r.useState(null),[o,i]=r.useState([]),[h,p]=r.useState(!0),[_,f]=r.useState(null),[N,n]=r.useState(null),b=r.useCallback(async()=>{try{const[g,j]=await Promise.all([as(),rs(a,l)]);u(g),i(j.samples),f(null),n(new Date)}catch(g){f(g instanceof Error?g.message:"Failed to fetch CPU data")}finally{p(!1)}},[a,l]);return r.useEffect(()=>{if(!x)return;b();const g=setInterval(b,t);return()=>clearInterval(g)},[b,t,x]),{current:m,history:o,loading:h,error:_,refetch:b,lastUpdated:N}}function Cs(s={}){const{pollInterval:t=5e3,historyDuration:a="1h",source:l="auto",enabled:x=!0}=s,[m,u]=r.useState(null),[o,i]=r.useState([]),[h,p]=r.useState(!0),[_,f]=r.useState(null),[N,n]=r.useState(null),b=r.useCallback(async()=>{try{const[g,j]=await Promise.all([ls(),ns(a,l)]);u(g),i(j.samples),f(null),n(new Date)}catch(g){f(g instanceof Error?g.message:"Failed to fetch memory data")}finally{p(!1)}},[a,l]);return r.useEffect(()=>{if(!x)return;b();const g=setInterval(b,t);return()=>clearInterval(g)},[b,t,x]),{current:m,history:o,loading:h,error:_,refetch:b,lastUpdated:N}}function Ds(s={}){const{pollInterval:t=5e3,historyDuration:a="1h",source:l="auto",enabled:x=!0}=s,[m,u]=r.useState(null),[o,i]=r.useState([]),[h,p]=r.useState(!0),[_,f]=r.useState(null),[N,n]=r.useState(null),b=r.useCallback(async()=>{try{const[g,j]=await Promise.all([is(),os(a,l)]);u(g),i(j.samples),f(null),n(new Date)}catch(g){f(g instanceof Error?g.message:"Failed to fetch network data")}finally{p(!1)}},[a,l]);return r.useEffect(()=>{if(!x)return;b();const g=setInterval(b,t);return()=>clearInterval(g)},[b,t,x]),{current:m,history:o,loading:h,error:_,refetch:b,lastUpdated:N}}function Ls(s={}){const{pollInterval:t=5e3,historyDuration:a="1h",source:l="auto",diskName:x,enabled:m=!0}=s,[u,o]=r.useState({}),[i,h]=r.useState({}),[p,_]=r.useState([]),[f,N]=r.useState(!0),[n,b]=r.useState(null),[g,j]=r.useState(null),L=r.useCallback(async()=>{try{const[E,v]=await Promise.all([cs(),ds(a,l,x)]);o(E.disks),h(v.disks),_(v.available_disks),b(null),j(new Date)}catch(E){b(E instanceof Error?E.message:"Failed to fetch disk I/O data")}finally{N(!1)}},[a,l,x]),C=p.length===0&&!n?1e3:t;return r.useEffect(()=>{if(!m)return;L();const E=setInterval(L,C);return()=>clearInterval(E)},[L,C,m]),{disks:u,history:i,availableDisks:p,loading:f,error:n,refetch:L,lastUpdated:g}}function T({label:s,value:t,unit:a,subValue:l,color:x,icon:m}){return e.jsx("div",{className:`card border-${x}-500/20 bg-gradient-to-br from-${x}-500/10 to-transparent p-3 sm:p-5`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-[10px] sm:text-xs font-medium uppercase tracking-wider text-slate-400 truncate",children:s}),e.jsxs("p",{className:"mt-1 sm:mt-2 text-lg sm:text-2xl font-semibold text-white truncate",children:[t,a&&e.jsx("span",{className:"ml-1 text-sm sm:text-lg text-slate-400",children:a})]}),l&&e.jsx("p",{className:"mt-0.5 sm:mt-1 text-xs sm:text-sm text-slate-400 truncate",children:l})]}),e.jsx("div",{className:`rounded-full bg-${x}-500/20 p-2 sm:p-3 flex-shrink-0 ml-2`,children:m})]})})}function Es({timeRange:s}){const{t}=P(["system","common"]),{current:a,history:l,loading:x,error:m}=Ss({historyDuration:s}),[u,o]=r.useState("overall"),i=r.useMemo(()=>l.filter(n=>n.usage_percent!==void 0&&n.usage_percent>=0).map(n=>({time:n.timestamp,usage:n.usage_percent})),[l]),h=r.useMemo(()=>{if(u!=="per-thread"||!a?.thread_usages)return[];const n=a.p_core_count??0,b=a.e_core_count??0,g=a.thread_usages.length,j=n*2;return a.thread_usages.map((L,C)=>{let E="normal",v="#3b82f6";n>0||b>0?C<j?(E="P",v=`hsl(${210+C%4*10}, 75%, ${60+C%3*8}%)`):(E="E",v=`hsl(${140+C%4*15}, 70%, ${55+C%3*8}%)`):v=`hsl(${C/g*360}, 70%, 60%)`;const y=l.map(w=>({time:w.timestamp,usage:w.thread_usages?.[C]??0}));return{threadIndex:C,threadType:E,color:v,currentUsage:L,chartData:y,label:E==="normal"?`CPU ${C}`:`${E==="P"?"P-Core":"E-Core"} ${C}`}})},[l,u,a]),p=(a?.p_core_count??0)>0||(a?.e_core_count??0)>0,_=r.useMemo(()=>l.filter(n=>n.temperature_celsius!==null&&n.temperature_celsius!==void 0).map(n=>({time:n.timestamp,temperature:n.temperature_celsius})),[l]),f=_.length>0,N=r.useMemo(()=>{if(!a)return null;const n=a.core_count??0,b=a.thread_count??n,g=a.p_core_count,j=a.e_core_count;return g!=null&&j!==null&&j!==void 0?{main:t("monitor.coresThreads",{cores:n,threads:b}),detail:`${g} ${t("monitor.pCores")}, ${j} ${t("monitor.eCores")}`,isHybrid:!0}:{main:`${n} ${t("monitor.cores")}`,detail:`${b} ${t("monitor.threads")}`,isHybrid:!1}},[a]);return m?e.jsx("div",{className:"text-red-400 text-center py-8",children:m}):e.jsxs("div",{className:"space-y-4 sm:space-y-6 min-w-0",children:[e.jsxs("div",{className:"grid grid-cols-1 min-[400px]:grid-cols-2 gap-3 sm:gap-5 lg:grid-cols-4",children:[e.jsx(T,{label:t("monitor.cpuUsage"),value:a?.usage_percent!=null?k(a.usage_percent,1):"0",unit:"%",color:"blue",icon:e.jsx("span",{className:"text-blue-400 text-base sm:text-xl",children:"%"})}),e.jsx(T,{label:t("monitor.frequency"),value:a?.frequency_mhz?k(a.frequency_mhz/1e3,2):"-",unit:"GHz",color:"purple",icon:e.jsx("span",{className:"text-purple-400 text-base sm:text-xl",children:"~"})}),e.jsx(T,{label:t("monitor.temperature"),value:a?.temperature_celsius!=null?k(a.temperature_celsius,1):"-",unit:"Â°C",color:"orange",icon:e.jsx("span",{className:"text-orange-400 text-base sm:text-xl",children:"ðŸŒ¡"})}),e.jsx("div",{className:"card border-slate-800/60 bg-gradient-to-br from-green-500/10 to-transparent p-3 sm:p-5",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-[10px] sm:text-xs font-medium uppercase tracking-wider text-slate-400",children:t("monitor.processor")}),e.jsx("p",{className:"mt-1 sm:mt-2 text-base sm:text-xl font-semibold text-white truncate",children:N?.main??"-"}),N?.detail&&e.jsx("p",{className:`mt-0.5 sm:mt-1 text-xs sm:text-sm truncate ${N.isHybrid?"text-cyan-400":"text-slate-400"}`,children:N.detail})]}),e.jsx("div",{className:"rounded-full bg-green-500/20 p-2 sm:p-3 flex-shrink-0 ml-2",children:e.jsx("span",{className:"text-green-400 text-base sm:text-xl",children:"#"})})]})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-white",children:t(u==="overall"?"monitor.cpuUsage":"monitor.cpuUsagePerThread")}),a?.thread_usages&&a.thread_usages.length>0&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>o("overall"),className:`flex-1 sm:flex-initial rounded-lg px-3 py-1.5 text-xs sm:text-sm font-medium transition-all touch-manipulation active:scale-95 ${u==="overall"?"bg-blue-500/20 text-blue-400":"text-slate-400 hover:bg-slate-800"}`,children:t("monitor.overall")}),e.jsx("button",{onClick:()=>o("per-thread"),className:`flex-1 sm:flex-initial rounded-lg px-3 py-1.5 text-xs sm:text-sm font-medium transition-all touch-manipulation active:scale-95 ${u==="per-thread"?"bg-blue-500/20 text-blue-400":"text-slate-400 hover:bg-slate-800"}`,children:t("monitor.perThread")})]})]}),u==="overall"&&e.jsx("div",{className:"card border-slate-800/60 bg-slate-900/55 p-4 sm:p-6",children:e.jsx(H,{data:i,lines:[{dataKey:"usage",name:t("monitor.usagePercent"),color:"#3b82f6"}],yAxisLabel:"%",yAxisDomain:[0,100],height:250,loading:x,showArea:!0,timeRange:s})}),u==="per-thread"&&h.length>0&&e.jsxs(e.Fragment,{children:[p&&h.some(n=>n.threadType==="P")&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-blue-500"}),e.jsxs("h4",{className:"text-sm sm:text-base font-semibold text-white",children:[t("monitor.pCoresPerformance")," - ",t("monitor.coresThreadsCount",{cores:a?.p_core_count,threads:(a?.p_core_count??0)*2})]})]}),e.jsx("div",{className:"grid grid-cols-1 min-[400px]:grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-3",children:h.filter(n=>n.threadType==="P").map(n=>e.jsxs("div",{className:"card border-slate-800/60 bg-gradient-to-br from-blue-500/5 to-transparent p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-slate-300",children:n.label}),e.jsxs("span",{className:"text-xs font-bold text-blue-400",children:[k(n.currentUsage,0),"%"]})]}),e.jsx(H,{data:n.chartData,lines:[{dataKey:"usage",name:"",color:n.color}],yAxisDomain:[0,100],height:100,loading:x,showArea:!0,compact:!0}),e.jsx("div",{className:"mt-2 h-1.5 w-full overflow-hidden rounded-full bg-slate-800",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-300",style:{width:`${n.currentUsage}%`,backgroundColor:n.color}})})]},n.threadIndex))})]}),p&&h.some(n=>n.threadType==="E")&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"h-3 w-3 rounded-full bg-green-500"}),e.jsxs("h4",{className:"text-sm sm:text-base font-semibold text-white",children:[t("monitor.eCoresEfficiency")," - ",t("monitor.coresThreadsCount",{cores:a?.e_core_count,threads:a?.e_core_count})]})]}),e.jsx("div",{className:"grid grid-cols-1 min-[400px]:grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-3",children:h.filter(n=>n.threadType==="E").map(n=>e.jsxs("div",{className:"card border-slate-800/60 bg-gradient-to-br from-green-500/5 to-transparent p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-slate-300",children:n.label}),e.jsxs("span",{className:"text-xs font-bold text-green-400",children:[k(n.currentUsage,0),"%"]})]}),e.jsx(H,{data:n.chartData,lines:[{dataKey:"usage",name:"",color:n.color}],yAxisDomain:[0,100],height:100,loading:x,showArea:!0,compact:!0}),e.jsx("div",{className:"mt-2 h-1.5 w-full overflow-hidden rounded-full bg-slate-800",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-300",style:{width:`${n.currentUsage}%`,backgroundColor:n.color}})})]},n.threadIndex))})]}),!p&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"text-sm sm:text-base font-semibold text-white",children:[t("monitor.logicalProcessors")," (",h.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 min-[400px]:grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6 gap-3",children:h.map(n=>e.jsxs("div",{className:"card border-slate-800/60 bg-slate-900/55 p-3",style:{background:`linear-gradient(to bottom right, ${n.color}08, transparent)`},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-slate-300",children:n.label}),e.jsxs("span",{className:"text-xs font-bold",style:{color:n.color},children:[k(n.currentUsage,0),"%"]})]}),e.jsx(H,{data:n.chartData,lines:[{dataKey:"usage",name:"",color:n.color}],yAxisDomain:[0,100],height:100,loading:x,showArea:!0,compact:!0}),e.jsx("div",{className:"mt-2 h-1.5 w-full overflow-hidden rounded-full bg-slate-800",children:e.jsx("div",{className:"h-full rounded-full transition-all duration-300",style:{width:`${n.currentUsage}%`,backgroundColor:n.color}})})]},n.threadIndex))})]})]}),f&&e.jsxs("div",{className:"card border-slate-800/60 bg-slate-900/55 p-4 sm:p-6",children:[e.jsx("h3",{className:"mb-3 sm:mb-4 text-base sm:text-lg font-semibold text-white",children:t("monitor.cpuTemperature")}),e.jsx(H,{data:_,lines:[{dataKey:"temperature",name:t("monitor.temperatureUnit"),color:"#f97316"}],yAxisLabel:"Â°C",yAxisDomain:[0,"auto"],height:250,loading:x,showArea:!0,timeRange:s})]})]})}function Ms({timeRange:s}){const{t}=P(["system","common"]),{current:a,history:l,loading:x,error:m}=Cs({historyDuration:s}),u=a?a.total_bytes/(1024*1024*1024):16,o=r.useMemo(()=>l.filter(h=>h.used_bytes>0&&h.total_bytes>0).map(h=>({time:h.timestamp,usedGb:h.used_bytes/(1024*1024*1024),baluhostGb:h.baluhost_memory_bytes&&h.baluhost_memory_bytes>0?h.baluhost_memory_bytes/(1024*1024*1024):null})),[l]),i=o.some(h=>h.baluhostGb!==null);return m?e.jsx("div",{className:"text-red-400 text-center py-8",children:m}):e.jsxs("div",{className:"space-y-4 sm:space-y-6 min-w-0",children:[e.jsxs("div",{className:"grid grid-cols-1 min-[400px]:grid-cols-2 gap-3 sm:gap-5 lg:grid-cols-5",children:[e.jsx(T,{label:t("monitor.used"),value:a?F(a.used_bytes):"-",color:"purple",icon:e.jsx("span",{className:"text-purple-400 text-base sm:text-xl",children:"ðŸ“Š"})}),e.jsx(T,{label:t("monitor.total"),value:a?F(a.total_bytes):"-",color:"blue",icon:e.jsx("span",{className:"text-blue-400 text-base sm:text-xl",children:"Î£"})}),e.jsx(T,{label:t("monitor.available"),value:a?.available_bytes?F(a.available_bytes):"-",color:"green",icon:e.jsx("span",{className:"text-green-400 text-base sm:text-xl",children:"âœ“"})}),e.jsx(T,{label:t("monitor.utilization"),value:a?.percent!=null?k(a.percent,1):"0",unit:"%",color:"orange",icon:e.jsx("span",{className:"text-orange-400 text-base sm:text-xl",children:"%"})}),e.jsx(T,{label:"BaluHost",value:a?.baluhost_memory_bytes?F(a.baluhost_memory_bytes):"-",color:"cyan",icon:e.jsx("span",{className:"text-cyan-400 text-base sm:text-xl",children:"ðŸ "})})]}),e.jsxs("div",{className:"card border-slate-800/60 bg-slate-900/55 p-4 sm:p-6",children:[e.jsx("h3",{className:"mb-3 sm:mb-4 text-base sm:text-lg font-semibold text-white",children:t("monitor.ramHistory")}),e.jsx(H,{data:o,lines:[{dataKey:"usedGb",name:t("monitor.usedGb"),color:"#a855f7"},...i?[{dataKey:"baluhostGb",name:t("monitor.baluhostGb"),color:"#06b6d4"}]:[]],yAxisLabel:"GB",yAxisDomain:[0,Math.ceil(u)],height:300,loading:x,showArea:!0,timeRange:s})]})]})}function Ts({timeRange:s}){const{t}=P(["system","common"]),{current:a,history:l,loading:x,error:m}=Ds({historyDuration:s}),u=r.useMemo(()=>l.filter(o=>o.download_mbps!==void 0&&o.upload_mbps!==void 0).map(o=>({time:o.timestamp,download:o.download_mbps,upload:o.upload_mbps})),[l]);return m?e.jsx("div",{className:"text-red-400 text-center py-8",children:m}):e.jsxs("div",{className:"space-y-4 sm:space-y-6 min-w-0",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-5",children:[e.jsx(T,{label:t("monitor.download"),value:a?.download_mbps!=null?k(a.download_mbps,2):"0",unit:"Mbit/s",color:"blue",icon:e.jsx("span",{className:"text-blue-400 text-base sm:text-xl",children:"â†“"})}),e.jsx(T,{label:t("monitor.upload"),value:a?.upload_mbps!=null?k(a.upload_mbps,2):"0",unit:"Mbit/s",color:"green",icon:e.jsx("span",{className:"text-green-400 text-base sm:text-xl",children:"â†‘"})})]}),e.jsxs("div",{className:"card border-slate-800/60 bg-slate-900/55 p-4 sm:p-6",children:[e.jsx("h3",{className:"mb-3 sm:mb-4 text-base sm:text-lg font-semibold text-white",children:t("monitor.networkHistory")}),e.jsx(H,{data:u,lines:[{dataKey:"download",name:t("monitor.downloadMbps"),color:"#3b82f6"},{dataKey:"upload",name:t("monitor.uploadMbps"),color:"#10b981"}],yAxisLabel:"Mbit/s",height:300,loading:x,timeRange:s})]})]})}async function $s(){return(await U.get("/api/benchmark/disks")).data}async function As(){return(await U.get("/api/benchmark/profiles")).data}async function Ps(s){return(await U.post("/api/benchmark/start",s)).data}async function Bs(s){return(await U.get(`/api/benchmark/${s}`)).data}async function Is(s){return(await U.get(`/api/benchmark/${s}/progress`)).data}async function Fs(s){return(await U.post(`/api/benchmark/${s}/cancel`)).data}async function Us(s){return(await U.post(`/api/benchmark/${s}/mark-failed`)).data}async function Ks(s=1,t=10,a){const l={page:s,page_size:t};return(await U.get("/api/benchmark/",{params:l})).data}function O(s){return s==null?"-":s>=1e3?`${k(s/1e3,2)} GB/s`:`${k(s,1)} MB/s`}function G(s){return s==null?"-":s>=1e6?`${k(s/1e6,2)}M`:s>=1e3?`${k(s/1e3,1)}K`:k(s,0)}function ce(s){if(s==null)return"-";if(s<60)return`${k(s,0)}s`;const t=Math.floor(s/60),a=Math.floor(s%60);if(t<60)return`${t}m ${a}s`;const l=Math.floor(t/60),x=t%60;return`${l}h ${x}m`}function Rs(){const[s,t]=r.useState([]),[a,l]=r.useState(!0),[x,m]=r.useState(null),u=r.useCallback(async()=>{try{l(!0);const o=await $s();t(o.disks),m(null)}catch(o){const i=o!=null&&typeof o=="object"&&"response"in o?o.response?.data?.detail:void 0;m(i||(o instanceof Error?o.message:"Failed to load disks"))}finally{l(!1)}},[]);return r.useEffect(()=>{u()},[u]),{disks:s,loading:a,error:x,refetch:u}}function Hs(){const[s,t]=r.useState([]),[a,l]=r.useState(!0),[x,m]=r.useState(null),u=r.useCallback(async()=>{try{l(!0);const o=await As();t(o.profiles),m(null)}catch(o){const i=o!=null&&typeof o=="object"&&"response"in o?o.response?.data?.detail:void 0;m(i||(o instanceof Error?o.message:"Failed to load profiles"))}finally{l(!1)}},[]);return r.useEffect(()=>{u()},[u]),{profiles:s,loading:a,error:x,refetch:u}}function Ws(s){const[t,a]=r.useState(null),[l,x]=r.useState(!1),[m,u]=r.useState(null),o=r.useCallback(async()=>{if(s!==null)try{x(!0);const i=await Bs(s);a(i),u(null)}catch(i){const h=i!=null&&typeof i=="object"&&"response"in i?i.response?.data?.detail:void 0;u(h||(i instanceof Error?i.message:"Failed to load benchmark"))}finally{x(!1)}},[s]);return r.useEffect(()=>{s!==null?o():a(null)},[s,o]),{benchmark:t,loading:l,error:m,refetch:o}}function zs(s,t={}){const{pollingInterval:a=1e3,autoStopOnComplete:l=!0}=t,[x,m]=r.useState(null),[u,o]=r.useState(!1),[i,h]=r.useState(null),[p,_]=r.useState(!1),f=r.useRef(null),N=r.useCallback(async()=>{if(s!==null)try{const g=await Is(s);m(g),h(null),l&&Qs(g.status)&&(_(!1),f.current&&(clearInterval(f.current),f.current=null))}catch(g){const j=g!=null&&typeof g=="object"&&"response"in g?g.response?.data?.detail:void 0;h(j||(g instanceof Error?g.message:"Failed to load progress"))}},[s,l]),n=r.useCallback(()=>{s===null||p||(_(!0),o(!0),N().finally(()=>o(!1)),f.current=setInterval(N,a))},[s,p,N,a]),b=r.useCallback(()=>{_(!1),f.current&&(clearInterval(f.current),f.current=null)},[]);return r.useEffect(()=>()=>{f.current&&clearInterval(f.current)},[]),r.useEffect(()=>{b(),m(null),h(null)},[s,b]),{progress:x,loading:u,error:i,isPolling:p,startPolling:n,stopPolling:b}}function qs(s=10,t){const[a,l]=r.useState([]),[x,m]=r.useState(0),[u,o]=r.useState(1),[i,h]=r.useState(1),[p,_]=r.useState(!0),[f,N]=r.useState(null),n=r.useCallback(async()=>{try{_(!0);const b=await Ks(u,s,t);l(b.items),m(b.total),h(b.total_pages),N(null)}catch(b){const g=b!=null&&typeof b=="object"&&"response"in b?b.response?.data?.detail:void 0;N(g||(b instanceof Error?b.message:"Failed to load history"))}finally{_(!1)}},[u,s,t]);return r.useEffect(()=>{n()},[n]),{benchmarks:a,total:x,page:u,totalPages:i,loading:p,error:f,refetch:n,setPage:o}}function Os(){const[s,t]=r.useState(!1),[a,l]=r.useState(null),[x,m]=r.useState(null);return{start:r.useCallback(async o=>{try{t(!0),l(null);const i=await Ps(o);return m(i),i}catch(i){const h=i!=null&&typeof i=="object"&&"response"in i?i.response?.data?.detail:void 0;throw l(h||(i instanceof Error?i.message:"Failed to start benchmark")),i}finally{t(!1)}},[]),loading:s,error:a,benchmark:x}}function Gs(){const[s,t]=r.useState(!1),[a,l]=r.useState(null);return{cancel:r.useCallback(async m=>{try{t(!0),l(null),await Fs(m)}catch(u){const o=u!=null&&typeof u=="object"&&"response"in u?u.response?.data?.detail:void 0;throw l(o||(u instanceof Error?u.message:"Failed to cancel benchmark")),u}finally{t(!1)}},[]),loading:s,error:a}}function Vs(){const[s,t]=r.useState(!1),[a,l]=r.useState(null);return{markFailed:r.useCallback(async m=>{try{t(!0),l(null),await Us(m)}catch(u){const o=u!=null&&typeof u=="object"&&"response"in u?u.response?.data?.detail:void 0;throw l(o||(u instanceof Error?u.message:"Failed to mark benchmark as failed")),u}finally{t(!1)}},[]),loading:s,error:a}}function Qs(s){return s==="completed"||s==="failed"||s==="cancelled"}function Ys(s){switch(s){case"completed":return"bg-green-100 text-green-800";case"running":return"bg-blue-100 text-blue-800";case"pending":return"bg-yellow-100 text-yellow-800";case"failed":return"bg-red-100 text-red-800";case"cancelled":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}}function Xs(s){return s.charAt(0).toUpperCase()+s.slice(1)}function Js({progress:s,onCancel:t,cancelLoading:a}){const{t:l}=P("system"),x=Math.round(s.progress_percent),m=s.current_test||l("benchmark.initializing"),u=s.estimated_remaining_seconds!==void 0&&s.estimated_remaining_seconds!==null?ce(s.estimated_remaining_seconds):l("benchmark.calculating");return e.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5 text-sky-500 animate-spin"}),e.jsx("span",{className:"font-medium text-white",children:l("benchmark.running")})]}),e.jsxs("button",{onClick:t,disabled:a,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm bg-red-600 hover:bg-red-700 disabled:bg-red-800 disabled:opacity-50 text-white rounded-lg transition-colors",children:[a?e.jsx(Y,{className:"w-4 h-4 animate-spin"}):e.jsx(Qe,{className:"w-4 h-4"}),l("benchmark.cancel")]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1.5",children:[e.jsx("span",{className:"text-sm text-slate-400",children:l("benchmark.progress")}),e.jsxs("span",{className:"text-sm font-medium text-sky-400",children:[x,"%"]})]}),e.jsx("div",{className:"w-full h-3 bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-sky-600 to-sky-400 transition-all duration-300",style:{width:`${x}%`}})})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-y-1 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsxs("span",{children:[l("benchmark.current"),":"]}),e.jsx("span",{className:"text-white font-mono",children:m})]}),e.jsxs("div",{className:"flex items-center gap-1.5 text-slate-400",children:[e.jsx(X,{className:"w-4 h-4"}),e.jsxs("span",{children:["~",u," ",l("benchmark.remaining")]})]})]})]})}function J({label:s,readValue:t,writeValue:a}){return e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("div",{className:"text-sm text-slate-400 font-medium py-2",children:s}),e.jsx("div",{className:"bg-slate-700/50 rounded-lg py-2 px-3 text-center",children:e.jsx("span",{className:"text-sky-400 font-mono text-base sm:text-lg font-semibold",children:t})}),e.jsx("div",{className:"bg-slate-700/50 rounded-lg py-2 px-3 text-center",children:e.jsx("span",{className:"text-rose-400 font-mono text-base sm:text-lg font-semibold",children:a})})]})}function Zs({results:s,diskName:t,diskModel:a}){const{t:l}=P("system");return s.seq_read_mbps!==void 0||s.seq_write_mbps!==void 0||s.rand_read_iops!==void 0||s.rand_write_iops!==void 0?e.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700 overflow-hidden",children:[e.jsx("div",{className:"bg-slate-900 px-4 py-3 border-b border-slate-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-white",children:t}),a&&e.jsx("p",{className:"text-xs text-slate-400 mt-0.5",children:a})]}),e.jsx("div",{className:"text-xs text-slate-500 font-mono",children:l("benchmark.crystalDiskMarkStyle")})]})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[e.jsx("div",{className:"text-sm font-medium text-slate-500"}),e.jsx("div",{className:"text-center text-sm font-medium text-sky-500",children:l("benchmark.read")}),e.jsx("div",{className:"text-center text-sm font-medium text-rose-500",children:l("benchmark.write")})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx(J,{label:"SEQ1M Q8T1",readValue:O(s.seq_read_mbps),writeValue:O(s.seq_write_mbps)}),(s.seq_read_q1_mbps!==void 0||s.seq_write_q1_mbps!==void 0)&&e.jsx(J,{label:"SEQ1M Q1T1",readValue:O(s.seq_read_q1_mbps),writeValue:O(s.seq_write_q1_mbps)})]}),e.jsx("div",{className:"border-t border-slate-700 my-4"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(J,{label:"RND4K Q32T1",readValue:G(s.rand_read_iops),writeValue:G(s.rand_write_iops)}),(s.rand_read_q1_iops!==void 0||s.rand_write_q1_iops!==void 0)&&e.jsx(J,{label:"RND4K Q1T1",readValue:G(s.rand_read_q1_iops),writeValue:G(s.rand_write_q1_iops)})]}),e.jsx("div",{className:"mt-4 pt-3 border-t border-slate-700",children:e.jsxs("div",{className:"flex flex-wrap gap-4 text-xs text-slate-500",children:[e.jsxs("span",{children:[e.jsx("strong",{children:"SEQ"})," = ",l("benchmark.sequential")]}),e.jsxs("span",{children:[e.jsx("strong",{children:"RND"})," = ",l("benchmark.random")]}),e.jsxs("span",{children:[e.jsx("strong",{children:"Q"})," = ",l("benchmark.queueDepth")]}),e.jsxs("span",{children:[e.jsx("strong",{children:"T"})," = ",l("benchmark.threads")]})]})})]})]}):e.jsx("div",{className:"bg-slate-800 rounded-lg p-6 border border-slate-700 text-center text-slate-400",children:l("benchmark.noResults")})}function et({results:s}){const{t}=P("system");return e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-slate-500",children:[t("benchmark.seqRead"),":"]}),e.jsx("span",{className:"text-sky-400 font-mono",children:O(s.seq_read_mbps)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-slate-500",children:[t("benchmark.seqWrite"),":"]}),e.jsx("span",{className:"text-rose-400 font-mono",children:O(s.seq_write_mbps)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-slate-500",children:[t("benchmark.randRead"),":"]}),e.jsxs("span",{className:"text-sky-400 font-mono",children:[G(s.rand_read_iops)," IOPS"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-slate-500",children:[t("benchmark.randWrite"),":"]}),e.jsxs("span",{className:"text-rose-400 font-mono",children:[G(s.rand_write_iops)," IOPS"]})]})]})}function st(){const{t:s}=P("system"),[t,a]=r.useState(""),[l,x]=r.useState("quick"),[m,u]=r.useState(null),[o,i]=r.useState(!1),{disks:h,loading:p,error:_}=Rs(),{profiles:f,loading:N}=Hs(),{start:n,loading:b,error:g}=Os(),{cancel:j,loading:L}=Gs(),{benchmark:C,refetch:E}=Ws(m),{progress:v,startPolling:y,stopPolling:w}=zs(m),{benchmarks:c,loading:M,refetch:$}=qs(5);r.useEffect(()=>{if(h.length>0&&!t){const D=h.find(W=>W.can_benchmark);a(D?D.name:h[0].name)}},[h,t]),r.useEffect(()=>{v&&at(v.status)&&(w(),E(),$(),v.status==="completed"?B.success("Benchmark completed successfully!"):v.status==="cancelled"?B("Benchmark cancelled",{icon:"âš ï¸"}):v.status==="failed"&&B.error("Benchmark failed"))},[v,w,E,$]);const I=r.useCallback(async()=>{if(!t){B.error("Please select a disk");return}const D=h.find(W=>W.name===t);if(D&&!D.can_benchmark){B.error(`Cannot benchmark ${t}: ${D.warning||"Disk not available"}`);return}try{const W=await n({disk_name:t,profile:l});u(W.id),y(),B.success("Benchmark started!")}catch{}},[t,l,h,n,y]),d=r.useCallback(async()=>{if(m!==null)try{await j(m),B.success("Cancellation requested")}catch{B.error("Failed to cancel benchmark")}},[m,j]),S=h.find(D=>D.name===t),A=f.find(D=>D.name===l),R=v?.status==="running"||v?.status==="pending";return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ye,{className:"w-5 h-5 text-sky-500"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:s("benchmark.title")}),e.jsxs("span",{className:"text-xs text-slate-500 ml-2",children:["(",s("benchmark.crystalDiskMarkStyle"),")"]})]}),(_||g)&&e.jsx("div",{className:"bg-red-900/30 border border-red-700 rounded-lg px-4 py-3 text-sm text-red-300",children:_||g}),!R&&e.jsxs("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1.5",children:s("benchmark.selectDisk")}),e.jsxs("div",{className:"relative",children:[e.jsx(ee,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500"}),e.jsxs("select",{value:t,onChange:D=>a(D.target.value),disabled:p||R,className:"w-full pl-10 pr-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-sky-500 disabled:opacity-50",children:[p&&e.jsx("option",{children:s("benchmark.loadingDisks")}),h.map(D=>e.jsxs("option",{value:D.name,disabled:!D.can_benchmark,children:[D.name," - ",D.size_display," ",D.model?`(${D.model})`:""," ",!D.can_benchmark&&"âš ï¸"]},D.name))]})]}),S&&!S.can_benchmark&&e.jsxs("p",{className:"mt-1.5 text-xs text-amber-400 flex items-center gap-1",children:[e.jsx(Q,{className:"w-3 h-3"}),S.warning]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1.5",children:s("benchmark.profile")}),e.jsx("select",{value:l,onChange:D=>x(D.target.value),disabled:N||R,className:"w-full px-4 py-2 bg-slate-900 border border-slate-700 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-sky-500 disabled:opacity-50",children:f.map(D=>e.jsxs("option",{value:D.name,children:[D.display_name," (~",ce(D.estimated_duration_seconds),")"]},D.name))}),A&&e.jsx("p",{className:"mt-1.5 text-xs text-slate-500",children:A.description})]})]}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsxs("button",{onClick:I,disabled:b||R||!S?.can_benchmark,className:"flex items-center gap-2 px-4 py-2 bg-sky-600 hover:bg-sky-700 disabled:bg-slate-700 disabled:opacity-50 text-white rounded-lg font-medium transition-colors",children:[b?e.jsx(Y,{className:"w-4 h-4 animate-spin"}):e.jsx(Xe,{className:"w-4 h-4"}),s("benchmark.start")]})})]}),R&&v&&e.jsx(Js,{progress:v,onCancel:d,cancelLoading:L}),C&&C.status==="completed"&&e.jsx(Zs,{results:C.summary,diskName:C.disk_name,diskModel:C.disk_model}),C&&C.status==="failed"&&e.jsxs("div",{className:"bg-red-900/30 border border-red-700 rounded-lg px-4 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-red-300",children:[e.jsx(K,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:s("benchmark.failed")})]}),C.error_message&&e.jsx("p",{className:"mt-2 text-sm text-red-400",children:C.error_message})]}),e.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700 overflow-hidden",children:[e.jsxs("button",{onClick:()=>i(!o),className:"w-full flex items-center justify-between px-4 py-3 hover:bg-slate-700/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"w-4 h-4 text-slate-400"}),e.jsx("span",{className:"font-medium text-white",children:s("benchmark.history")}),e.jsxs("span",{className:"text-sm text-slate-500",children:["(",c.length," ",s("benchmark.recent"),")"]})]}),o?e.jsx(ae,{className:"w-4 h-4 text-slate-400"}):e.jsx(re,{className:"w-4 h-4 text-slate-400"})]}),o&&e.jsx("div",{className:"border-t border-slate-700",children:M?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(Y,{className:"w-6 h-6 text-slate-400 animate-spin"})}):c.length===0?e.jsx("div",{className:"text-center py-8 text-slate-500",children:s("benchmark.noHistory")}):e.jsx("div",{className:"divide-y divide-slate-700",children:c.map(D=>e.jsx(tt,{benchmark:D,onRefetch:$},D.id))})})]})]})}function tt({benchmark:s,onRefetch:t}){const[a,l]=r.useState(!1),{markFailed:x,loading:m}=Vs(),u=rt(s.status),o=Ys(s.status),i=s.status==="running"||s.status==="pending",h=async p=>{p.stopPropagation();try{await x(s.id),B.success("Benchmark marked as failed"),await t()}catch{B.error("Failed to mark benchmark as failed")}};return e.jsxs("div",{className:"px-4 py-3",children:[e.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>l(!a),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[u,e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-white",children:s.disk_name}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${o}`,children:Xs(s.status)})]}),e.jsxs("div",{className:"text-xs text-slate-500 mt-0.5",children:[new Date(s.created_at).toLocaleString()," â€¢ ",s.profile," profile",s.duration_seconds&&` â€¢ ${ce(s.duration_seconds)}`]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsx("button",{onClick:h,disabled:m,className:"text-xs px-2 py-1 bg-red-900/50 hover:bg-red-800/60 border border-red-700 text-red-300 rounded transition-colors disabled:opacity-50",children:m?"Marking...":"Mark Failed"}),s.status==="completed"&&e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{className:"text-sky-400",children:[s.summary.seq_read_mbps!=null?k(s.summary.seq_read_mbps,0):"-"," MB/s"]}),e.jsx("div",{className:"text-xs text-slate-500",children:"seq read"})]})]})]}),a&&s.status==="completed"&&e.jsx("div",{className:"mt-3 pt-3 border-t border-slate-700",children:e.jsx(et,{results:s.summary})})]})}function at(s){return s==="completed"||s==="failed"||s==="cancelled"}function rt(s){switch(s){case"completed":return e.jsx(q,{className:"w-5 h-5 text-green-500"});case"running":return e.jsx(Y,{className:"w-5 h-5 text-blue-500 animate-spin"});case"pending":return e.jsx(X,{className:"w-5 h-5 text-yellow-500"});case"failed":return e.jsx(K,{className:"w-5 h-5 text-red-500"});case"cancelled":return e.jsx(K,{className:"w-5 h-5 text-gray-500"});default:return e.jsx(ee,{className:"w-5 h-5 text-slate-500"})}}function lt({timeRange:s}){const{t}=P(["system","common"]),{disks:a,history:l,availableDisks:x,loading:m,error:u}=Ls({historyDuration:s}),[o,i]=r.useState(null),[h,p]=r.useState("throughput");r.useEffect(()=>{!o&&x.length>0&&i(x[0])},[x,o]);const _=r.useMemo(()=>!o||!l[o]?[]:l[o].filter(N=>N.read_mbps!==void 0&&N.write_mbps!==void 0).map(N=>({time:N.timestamp,read:h==="throughput"?N.read_mbps:N.read_iops,write:h==="throughput"?N.write_mbps:N.write_iops})),[o,l,h]),f=o?a[o]:null;return u?e.jsx("div",{className:"text-red-400 text-center py-8",children:u}):e.jsxs("div",{className:"space-y-4 sm:space-y-6 min-w-0",children:[x.length>0&&e.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",children:e.jsx("div",{className:"flex gap-2 sm:gap-3 sm:flex-wrap min-w-max sm:min-w-0",children:x.map(N=>e.jsx("button",{onClick:()=>i(N),className:`whitespace-nowrap rounded-lg border px-3 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm font-medium transition-all touch-manipulation active:scale-95 ${o===N?"border-blue-500 bg-blue-500/10 text-blue-400":"border-slate-700 bg-slate-800/50 text-slate-400 hover:border-slate-600 hover:bg-slate-800"}`,children:N},N))})}),o&&e.jsxs("div",{className:"grid grid-cols-1 min-[400px]:grid-cols-2 gap-3 sm:gap-5 lg:grid-cols-6",children:[e.jsx(T,{label:t("monitor.read"),value:f?.read_mbps!=null?k(f.read_mbps,2):"0",unit:"MB/s",color:"blue",icon:e.jsx("span",{className:"text-blue-400 text-base sm:text-xl",children:"ðŸ“–"})}),e.jsx(T,{label:t("monitor.write"),value:f?.write_mbps!=null?k(f.write_mbps,2):"0",unit:"MB/s",color:"green",icon:e.jsx("span",{className:"text-green-400 text-base sm:text-xl",children:"âœï¸"})}),e.jsx(T,{label:t("monitor.readIops"),value:f?.read_iops!=null?k(f.read_iops,0):"0",color:"purple",icon:e.jsx("span",{className:"text-purple-400 text-base sm:text-xl",children:"âš¡"})}),e.jsx(T,{label:t("monitor.writeIops"),value:f?.write_iops!=null?k(f.write_iops,0):"0",color:"orange",icon:e.jsx("span",{className:"text-orange-400 text-base sm:text-xl",children:"âš¡"})}),e.jsx(T,{label:t("monitor.responseTime"),value:f?.avg_response_ms!=null?k(f.avg_response_ms,2):"-",unit:"ms",color:"cyan",icon:e.jsx("span",{className:"text-cyan-400 text-base sm:text-xl",children:"â±"})}),e.jsx(T,{label:t("monitor.activeTime"),value:f?.active_time_percent!=null?k(f.active_time_percent,1):"-",unit:"%",color:"teal",icon:e.jsx("span",{className:"text-teal-400 text-base sm:text-xl",children:"ðŸ“Š"})})]}),o&&e.jsxs("div",{className:"card border-slate-800/60 bg-slate-900/55 p-4 sm:p-6",children:[e.jsxs("div",{className:"mb-3 sm:mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-white",children:[o," - ",t("monitor.history")]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>p("throughput"),className:`flex-1 sm:flex-initial rounded-lg px-3 py-1.5 text-xs sm:text-sm font-medium transition-all touch-manipulation active:scale-95 ${h==="throughput"?"bg-blue-500/20 text-blue-400":"text-slate-400 hover:bg-slate-800"}`,children:t("monitor.throughput")}),e.jsx("button",{onClick:()=>p("iops"),className:`flex-1 sm:flex-initial rounded-lg px-3 py-1.5 text-xs sm:text-sm font-medium transition-all touch-manipulation active:scale-95 ${h==="iops"?"bg-blue-500/20 text-blue-400":"text-slate-400 hover:bg-slate-800"}`,children:t("monitor.iops")})]})]}),e.jsx(H,{data:_,lines:[{dataKey:"read",name:t(h==="throughput"?"monitor.readMbs":"monitor.readIops"),color:"#3b82f6"},{dataKey:"write",name:t(h==="throughput"?"monitor.writeMbs":"monitor.writeIops"),color:"#10b981"}],yAxisLabel:h==="throughput"?"MB/s":"IOPS",height:300,loading:m,timeRange:s})]}),x.length===0&&!m&&e.jsxs("div",{className:"text-center py-8 sm:py-12 text-slate-400",children:[e.jsx("p",{children:t("monitor.noDisksDetected")}),e.jsx("p",{className:"text-xs sm:text-sm text-slate-500 mt-1",children:t("monitor.waitingForData")})]}),e.jsx("div",{className:"border-t border-slate-800 pt-6 mt-6",children:e.jsx(st,{})})]})}async function nt(){return(await U.get("/api/energy/price")).data}async function it(s){return(await U.put("/api/energy/price",s)).data}async function he(s,t="today"){return(await U.get(`/api/energy/cumulative/${s}?period=${t}`)).data}function ot(){const{t:s,i18n:t}=P(["system","common"]),[a,l]=r.useState(null),[x,m]=r.useState(!0),[u,o]=r.useState(null),[i,h]=r.useState(null),[p,_]=r.useState(!1),[f,N]=r.useState(""),[n,b]=r.useState(!1),[g,j]=r.useState("today"),[L,C]=r.useState(null),[E,v]=r.useState(!1),[y,w]=r.useState(null),c=r.useCallback(async()=>{try{const d=await ms();l(d),o(null)}catch(d){if((d!=null&&typeof d=="object"&&"response"in d?d.response?.status:void 0)!==404){const R=d instanceof Error?d.message:"Failed to load power data";o(R)}}finally{m(!1)}},[]);r.useEffect(()=>{(async()=>{try{const S=await nt();h(S),N(S.cost_per_kwh.toString())}catch{}})()},[]),r.useEffect(()=>{a&&a.devices.length>0&&!y&&w(a.devices[0].device_id)},[a,y]),r.useEffect(()=>{if(!y)return;const d=async()=>{v(!0);try{const A=await he(y,g);C(A)}catch{}finally{v(!1)}};d();const S=setInterval(d,6e4);return()=>clearInterval(S)},[y,g]);const M=async()=>{const d=parseFloat(f);if(isNaN(d)||d<.01||d>10){B.error(s("monitor.power.priceMustBeBetween"));return}b(!0);try{const S=await it({cost_per_kwh:d,currency:i?.currency||"EUR"});if(h(S),_(!1),B.success(s("monitor.power.priceUpdated")),y){const A=await he(y,g);C(A)}}catch(S){const A=S!=null&&typeof S=="object"&&"response"in S?S.response?.data?.detail:void 0;B.error(Me(A,s("monitor.power.saveError")))}finally{b(!1)}};r.useEffect(()=>{c();const d=setInterval(c,5e3);return()=>clearInterval(d)},[c]);const $=r.useCallback(d=>{if(d.length<2)return 0;let S=0;for(let A=1;A<d.length;A++){const R=new Date(d[A-1].timestamp).getTime(),W=(new Date(d[A].timestamp).getTime()-R)/(1e3*60*60),De=(d[A-1].watts+d[A].watts)/2;S+=De*W}return S/1e3},[]),I=r.useMemo(()=>a?a.devices.reduce((d,S)=>d+$(S.samples),0):0,[a,$]);return x?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-slate-600 border-t-blue-500"})}):u?e.jsx("div",{className:"text-red-400 text-center py-8",children:u}):!a||a.devices.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-16 w-16 text-slate-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-9z"})}),e.jsx("p",{className:"mt-4 text-slate-400",children:s("monitor.power.noTapoDevices")}),e.jsx("p",{className:"text-sm text-slate-500 mt-1",children:s("monitor.power.configureTapoDevice")}),e.jsxs(ge,{to:"/admin/system-control?tab=smart",className:"inline-block mt-4 px-4 py-2 text-sm bg-sky-500/20 text-sky-400 hover:bg-sky-500/30 border border-sky-500/40 rounded-lg transition-colors",children:[s("monitor.power.configureSmartDevices")," â†’"]})]}):e.jsxs("div",{className:"space-y-4 sm:space-y-6 min-w-0",children:[e.jsxs("div",{className:"grid grid-cols-1 min-[400px]:grid-cols-2 gap-3 sm:gap-5 lg:grid-cols-4",children:[e.jsx(T,{label:s("monitor.power.currentPower"),value:k(a.total_current_power,1),unit:"W",color:"yellow",icon:e.jsx("span",{className:"text-yellow-400 text-base sm:text-xl",children:"âš¡"})}),e.jsx(T,{label:s("monitor.power.cumulativeSession"),value:k(I,4),unit:"kWh",color:"orange",icon:e.jsx("span",{className:"text-orange-400 text-base sm:text-xl",children:"Î£"})}),e.jsx(T,{label:s("monitor.power.todayTotal"),value:k(a.devices.reduce((d,S)=>d+(S.latest_sample?.energy_today??0),0),2),unit:"kWh",color:"green",icon:e.jsx("span",{className:"text-green-400 text-base sm:text-xl",children:"ðŸ“Š"})}),e.jsx(T,{label:s("monitor.power.devices"),value:a.devices.length,color:"blue",icon:e.jsx("span",{className:"text-blue-400 text-base sm:text-xl",children:"#"})})]}),a.devices.map(d=>{const S=$(d.samples);return e.jsxs("div",{className:"card border-slate-800/60 bg-slate-900/55 p-4 sm:p-6",children:[e.jsx("h3",{className:"mb-3 sm:mb-4 text-base sm:text-lg font-semibold text-white",children:d.device_name}),e.jsxs("div",{className:"grid grid-cols-1 min-[400px]:grid-cols-2 gap-3 sm:gap-4 lg:grid-cols-5",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-slate-400",children:s("monitor.power.powerLabel")}),e.jsxs("p",{className:"text-lg sm:text-xl font-semibold text-white",children:[d.latest_sample?.watts!=null?k(d.latest_sample.watts,1):"-"," ",e.jsx("span",{className:"text-sm sm:text-base text-slate-400",children:"W"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-slate-400",children:s("monitor.power.voltage")}),e.jsxs("p",{className:"text-lg sm:text-xl font-semibold text-white",children:[d.latest_sample?.voltage!=null?k(d.latest_sample.voltage,1):"-"," ",e.jsx("span",{className:"text-sm sm:text-base text-slate-400",children:"V"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-slate-400",children:s("monitor.power.current")}),e.jsxs("p",{className:"text-lg sm:text-xl font-semibold text-white",children:[d.latest_sample?.current!=null?k(d.latest_sample.current,3):"-"," ",e.jsx("span",{className:"text-sm sm:text-base text-slate-400",children:"A"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-slate-400",children:s("monitor.power.today")}),e.jsxs("p",{className:"text-lg sm:text-xl font-semibold text-white",children:[d.latest_sample?.energy_today!=null?k(d.latest_sample.energy_today,2):"-"," ",e.jsx("span",{className:"text-sm sm:text-base text-slate-400",children:"kWh"})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] sm:text-xs text-slate-400",children:s("monitor.power.cumulativeSession")}),e.jsxs("p",{className:"text-lg sm:text-xl font-semibold text-orange-400",children:[k(S,4)," ",e.jsx("span",{className:"text-sm sm:text-base text-slate-400",children:"kWh"})]})]})]}),d.samples.length>0&&e.jsx("div",{className:"mt-3 sm:mt-4",children:e.jsx(H,{data:d.samples.map(A=>({time:A.timestamp,watts:A.watts})),lines:[{dataKey:"watts",name:s("monitor.power.powerWatts"),color:"#eab308"}],height:180,showArea:!0,timeRange:"1h"})})]},d.device_id)}),e.jsxs("div",{className:"card border-slate-800/60 bg-slate-900/55 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-white",children:s("monitor.power.cumulativeConsumptionCosts")}),i&&e.jsx("div",{className:"flex items-center gap-2",children:p?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",step:"0.01",min:"0.01",max:"10",value:f,onChange:d=>N(d.target.value),className:"w-20 px-2 py-1 text-sm bg-slate-800 border border-slate-700 rounded text-white focus:border-blue-500 focus:outline-none",disabled:n}),e.jsxs("span",{className:"text-slate-400 text-sm",children:[i.currency,"/kWh"]}),e.jsx("button",{onClick:M,disabled:n,className:"px-2 py-1 text-xs bg-green-600 hover:bg-green-700 text-white rounded disabled:opacity-50",children:n?"...":"âœ“"}),e.jsx("button",{onClick:()=>{_(!1),N(i.cost_per_kwh.toString())},disabled:n,className:"px-2 py-1 text-xs bg-slate-700 hover:bg-slate-600 text-white rounded disabled:opacity-50",children:"âœ•"})]}):e.jsxs("button",{onClick:()=>_(!0),className:"flex items-center gap-1 px-2 py-1 text-xs bg-slate-800 hover:bg-slate-700 text-slate-300 rounded border border-slate-700",children:[e.jsxs("span",{children:[k(i.cost_per_kwh,2)," ",i.currency,"/kWh"]}),e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})]})})]}),e.jsx("div",{className:"flex gap-1 sm:gap-2",children:["today","week","month"].map(d=>e.jsx("button",{onClick:()=>j(d),className:`px-3 py-1.5 text-xs sm:text-sm rounded-md transition-colors ${g===d?"bg-blue-500/20 text-blue-400 border border-blue-500/40":"bg-slate-800 text-slate-400 hover:bg-slate-700 border border-transparent"}`,children:s(d==="today"?"monitor.power.periodToday":d==="week"?"monitor.power.periodWeek":"monitor.power.periodMonth")},d))})]}),L&&e.jsxs("div",{className:"grid grid-cols-1 min-[400px]:grid-cols-2 sm:grid-cols-4 gap-3 mb-4",children:[e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-slate-400",children:s("monitor.power.totalConsumption")}),e.jsxs("p",{className:"text-lg font-semibold text-emerald-400",children:[k(L.total_kwh,3)," ",e.jsx("span",{className:"text-sm text-slate-400",children:"kWh"})]})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-slate-400",children:s("monitor.power.totalCosts")}),e.jsxs("p",{className:"text-lg font-semibold text-orange-400",children:[k(L.total_cost,2)," ",e.jsx("span",{className:"text-sm text-slate-400",children:L.currency})]})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-slate-400",children:s("monitor.power.electricityPrice")}),e.jsxs("p",{className:"text-lg font-semibold text-slate-300",children:[k(L.cost_per_kwh,2)," ",e.jsxs("span",{className:"text-sm text-slate-400",children:[L.currency,"/kWh"]})]})]}),e.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-xs text-slate-400",children:s("monitor.power.dataPoints")}),e.jsx("p",{className:"text-lg font-semibold text-slate-300",children:L.data_points.length})]})]}),E?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-slate-600 border-t-blue-500"})}):L&&L.data_points.length>0?e.jsx("div",{className:"h-[300px] sm:h-[350px]",children:e.jsx(ve,{width:"100%",height:"100%",children:e.jsxs(ps,{data:L.data_points.map(d=>({time:je(d.timestamp,g,t.language),fullTime:oe(d.timestamp).toLocaleString(t.language),kwh:d.cumulative_kwh,cost:d.cumulative_cost,watts:d.instant_watts})),margin:{top:10,right:10,left:0,bottom:0},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorKwh",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10b981",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#10b981",stopOpacity:0})]})}),e.jsx(Ne,{strokeDasharray:"3 3",stroke:"#334155"}),e.jsx(we,{dataKey:"time",stroke:"#64748b",fontSize:11,tickLine:!1,interval:"preserveStartEnd",minTickGap:g==="week"?70:40}),e.jsx(ne,{yAxisId:"left",stroke:"#10b981",fontSize:11,tickLine:!1,axisLine:!1,tickFormatter:d=>k(d,2),label:{value:"kWh",angle:-90,position:"insideLeft",fill:"#10b981",fontSize:11}}),e.jsx(ne,{yAxisId:"right",orientation:"right",stroke:"#f97316",fontSize:11,tickLine:!1,axisLine:!1,tickFormatter:d=>k(d,2),label:{value:L.currency,angle:90,position:"insideRight",fill:"#f97316",fontSize:11}}),e.jsx(ke,{contentStyle:{backgroundColor:"#1e293b",border:"1px solid #334155",borderRadius:"8px",fontSize:"12px"},labelStyle:{color:"#94a3b8"},formatter:(d,S)=>S==="kwh"?[`${k(d,4)} kWh`,s("monitor.power.consumption")]:S==="cost"?[`${k(d,4)} ${L.currency}`,s("monitor.power.costsLabel")]:S==="watts"?[`${k(d,1)} W`,s("monitor.power.powerLabel")]:[d,S],labelFormatter:(d,S)=>S&&S[0]?S[0].payload.fullTime:d}),e.jsx(_e,{wrapperStyle:{fontSize:"12px"},formatter:d=>d==="kwh"?s("monitor.power.consumptionKwh"):d==="cost"?`${s("monitor.power.costsLabel")} (${L.currency})`:d}),e.jsx(Se,{yAxisId:"left",type:"monotone",dataKey:"kwh",stroke:"#10b981",strokeWidth:2,fill:"url(#colorKwh)",name:"kwh"}),e.jsx(Ce,{yAxisId:"right",type:"monotone",dataKey:"cost",stroke:"#f97316",strokeWidth:2,dot:!1,name:"cost"})]})})}):e.jsx("div",{className:"text-center py-8 text-slate-400",children:s("monitor.noDataForPeriod")})]})]})}const de=[{id:"hardware",labelKey:"monitor.categories.hardware",icon:e.jsx(be,{className:"h-4 w-4 sm:h-5 sm:w-5"}),tabs:[{id:"cpu",labelKey:"monitor.tabs.cpu",icon:e.jsxs("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,children:[e.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}),e.jsx("path",{d:"M9 9h6v6H9z"}),e.jsx("path",{d:"M9 1v3M15 1v3M9 20v3M15 20v3M1 9h3M1 15h3M20 9h3M20 15h3",strokeLinecap:"round"})]})},{id:"memory",labelKey:"monitor.tabs.memory",icon:e.jsxs("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,children:[e.jsx("rect",{x:"2",y:"6",width:"20",height:"12",rx:"2"}),e.jsx("path",{d:"M6 10v4M10 10v4M14 10v4M18 10v4",strokeLinecap:"round"})]})},{id:"power",labelKey:"monitor.tabs.power",icon:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{d:"M13 2L3 14h9l-1 8 10-12h-9l1-8z",strokeLinecap:"round",strokeLinejoin:"round"})})}]},{id:"io",labelKey:"monitor.categories.io",icon:e.jsx(Ze,{className:"h-4 w-4 sm:h-5 sm:w-5"}),tabs:[{id:"network",labelKey:"monitor.tabs.network",icon:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{d:"M5 12.55a11 11 0 0114.08 0M8.53 16.11a6 6 0 016.95 0M12 20h.01",strokeLinecap:"round",strokeLinejoin:"round"})})},{id:"disk-io",labelKey:"monitor.tabs.diskIo",icon:e.jsxs("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,children:[e.jsx("ellipse",{cx:"12",cy:"5",rx:"9",ry:"3"}),e.jsx("path",{d:"M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"}),e.jsx("path",{d:"M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"})]})}]},{id:"system",labelKey:"monitor.categories.system",icon:e.jsx(ie,{className:"h-4 w-4 sm:h-5 sm:w-5"}),tabs:[{id:"services",labelKey:"monitor.tabs.services",icon:e.jsxs("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,children:[e.jsx("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2"}),e.jsx("path",{d:"M8 21h8M12 17v4",strokeLinecap:"round"})]})},{id:"health",labelKey:"monitor.tabs.health",icon:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",strokeLinecap:"round",strokeLinejoin:"round"})})}]},{id:"logs",labelKey:"monitor.categories.logs",icon:e.jsx(fe,{className:"h-4 w-4 sm:h-5 sm:w-5"}),tabs:[{id:"logs",labelKey:"monitor.tabs.logs",icon:e.jsxs("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,children:[e.jsx("path",{d:"M4 5h16a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1Z",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M7 9h10",strokeLinecap:"round"}),e.jsx("path",{d:"M7 13h10",strokeLinecap:"round"}),e.jsx("path",{d:"M7 17h6",strokeLinecap:"round"})]})},{id:"activity",labelKey:"monitor.tabs.activity",icon:e.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",strokeLinecap:"round",strokeLinejoin:"round"})})}]}],ct=Object.fromEntries(de.flatMap(s=>s.tabs.map(t=>[t.id,s.id]))),dt=new Set(de.flatMap(s=>s.tabs.map(t=>t.id))),mt=new Set(["cpu","memory","network","disk-io"]);function ft(){const{t:s}=P(["system","common"]),{user:t,isAdmin:a}=pe(),[l,x]=$e(),[m,u]=r.useState("1h"),o=l.get("tab")||"cpu",i=dt.has(o)?o:"cpu",h=ct[i],p=r.useMemo(()=>de.map(n=>({...n,tabs:n.tabs.filter(b=>!b.adminOnly||a)})).filter(n=>n.tabs.length>0),[a]),_=p.find(n=>n.id===h)??p[0],f=n=>{x({tab:n})},N=n=>{const b=p.find(g=>g.id===n);x({tab:b.tabs[0].id})};return e.jsxs("div",{className:"space-y-6 min-w-0",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-semibold text-white",children:s("monitor.title")}),e.jsx("p",{className:"mt-1 text-xs sm:text-sm text-slate-400",children:s("monitor.subtitleLong")})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[mt.has(i)&&e.jsx(fs,{value:m,onChange:u}),e.jsxs("div",{className:"rounded-full border border-slate-800 bg-slate-900/70 px-3 sm:px-4 py-1.5 sm:py-2 text-xs text-slate-400 shadow-inner",children:[e.jsx("span",{className:"h-2 w-2 animate-pulse rounded-full bg-emerald-400 inline-block mr-2"}),s("monitor.live")]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0 scrollbar-none",children:e.jsx("div",{className:"flex gap-2 min-w-max sm:min-w-0 sm:flex-wrap",children:p.map(n=>e.jsxs("button",{onClick:()=>N(n.id),className:`flex items-center gap-2 rounded-xl px-4 py-2 sm:py-2.5 text-sm sm:text-base font-semibold transition-all whitespace-nowrap touch-manipulation active:scale-95 ${h===n.id?"bg-blue-500/20 text-blue-400 border border-blue-500/40 shadow-lg shadow-blue-500/10":"bg-slate-800/40 text-slate-400 hover:bg-slate-800/60 hover:text-slate-300 border border-slate-700/40"}`,children:[n.icon,e.jsx("span",{children:s(n.labelKey)})]},n.id))})}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0 scrollbar-none",children:e.jsx("div",{className:"flex gap-2 border-b border-slate-800 pb-3 min-w-max sm:min-w-0 sm:flex-wrap",children:_.tabs.map(n=>e.jsxs("button",{onClick:()=>f(n.id),className:`flex items-center gap-2 rounded-lg px-3 sm:px-4 py-2 sm:py-2.5 text-xs sm:text-sm font-medium transition-all whitespace-nowrap touch-manipulation active:scale-95 ${i===n.id?"bg-blue-500/20 text-blue-400 border border-blue-500/40":"text-slate-400 hover:bg-slate-800/50 hover:text-slate-300 border border-transparent"}`,children:[n.icon,e.jsx("span",{children:s(n.labelKey)}),n.adminOnly&&e.jsx(Te,{})]},n.id))})}),e.jsx("div",{className:"pointer-events-none absolute right-0 top-0 bottom-0 w-8 bg-gradient-to-l from-slate-950 to-transparent sm:hidden"})]})]}),e.jsxs("div",{className:"min-w-0",children:[i==="cpu"&&e.jsx(Es,{timeRange:m}),i==="memory"&&e.jsx(Ms,{timeRange:m}),i==="network"&&e.jsx(Ts,{timeRange:m}),i==="disk-io"&&e.jsx(lt,{timeRange:m}),i==="power"&&e.jsx(ot,{}),i==="services"&&e.jsx(_s,{isAdmin:a}),i==="health"&&e.jsx(js,{}),i==="logs"&&e.jsx(ys,{}),i==="activity"&&e.jsx(vs,{user:t??void 0})]})]})}export{ft as default};
